PREFIX gn: <https://www.geonames.org/ontology#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

CONSTRUCT {
  ?uri ?p ?o .
  ?doc ?dp ?dv .
}
WHERE {
  {
    ?uri a gn:Feature ;
         ?p ?o .

    # Filter out gn:parentCountry only for country entities
    FILTER(!(?p = gn:parentCountry && EXISTS {
      ?uri a gn:Feature ;
           gn:featureClass gn:A ;
           gn:featureCode gn:A.PCLI .
    }))

    # Filter out gn:nearbyFeatures triples for ADM1 features
    FILTER( !(
      ?p = gn:nearbyFeatures &&
      EXISTS {
        ?uri gn:featureClass gn:A ;
             gn:featureCode gn:A.ADM1 .
      }
    ))

    # Filter out gn:population triples where population is 0
    FILTER( !(
      ?p = gn:population &&
      ( ?o = 0 || ?o = "0"^^xsd:integer || ?o = "0" )
    ))
  }
  UNION
  {
    ?doc a foaf:Document ;
         ?dp ?dv .
  }
}
ORDER BY ?uri